{
  "config": {
    "run_id": "cnn_lstm_ln_seed46771_20251210_223100",
    "timestamp": "20251210_223100",
    "datetime": "2025-12-10T22:31:01.339124",
    "model_name": "cnn_lstm_ln",
    "model_file": "model_cnn_lstm_ln.py",
    "model_class": "CNNLSTMLN",
    "split_dir": "data/splits",
    "batch_size": 128,
    "num_epochs": 100,
    "patience": 10,
    "seed": 46771,
    "optimizer": "Adam",
    "learning_rate": 6.35e-05,
    "rnn_learning_rate": 2.79e-05,
    "differential_lr": true,
    "weight_decay": 0.000161,
    "freeze_cnn": true,
    "scheduler": "ReduceLROnPlateau",
    "scheduler_mode": "max",
    "scheduler_factor": 0.5,
    "scheduler_patience": 5,
    "gradient_clip_norm": 1.0,
    "save_dir": "checkpoints",
    "model_path": "checkpoints\\cnn_lstm_ln_seed46771_20251210_223100.pt",
    "log_path": "checkpoints\\cnn_lstm_ln_seed46771_20251210_223100_history.json",
    "results_path": "checkpoints\\cnn_lstm_ln_seed46771_20251210_223100_results.json",
    "device": "cuda",
    "user": "tomra",
    "platform": "Windows",
    "torch_version": "2.9.1+cu128",
    "model_parameters": 308676,
    "criterion": "CrossEntropyLoss",
    "class_weights": [
      0.4279378354549408,
      2.9077935218811035,
      0.8170527219772339,
      10.48245906829834
    ]
  },
  "history": {
    "config": {
      "run_id": "cnn_lstm_ln_seed46771_20251210_223100",
      "timestamp": "20251210_223100",
      "datetime": "2025-12-10T22:31:01.339124",
      "model_name": "cnn_lstm_ln",
      "model_file": "model_cnn_lstm_ln.py",
      "model_class": "CNNLSTMLN",
      "split_dir": "data/splits",
      "batch_size": 128,
      "num_epochs": 100,
      "patience": 10,
      "seed": 46771,
      "optimizer": "Adam",
      "learning_rate": 6.35e-05,
      "rnn_learning_rate": 2.79e-05,
      "differential_lr": true,
      "weight_decay": 0.000161,
      "freeze_cnn": true,
      "scheduler": "ReduceLROnPlateau",
      "scheduler_mode": "max",
      "scheduler_factor": 0.5,
      "scheduler_patience": 5,
      "gradient_clip_norm": 1.0,
      "save_dir": "checkpoints",
      "model_path": "checkpoints\\cnn_lstm_ln_seed46771_20251210_223100.pt",
      "log_path": "checkpoints\\cnn_lstm_ln_seed46771_20251210_223100_history.json",
      "results_path": "checkpoints\\cnn_lstm_ln_seed46771_20251210_223100_results.json",
      "device": "cuda",
      "user": "tomra",
      "platform": "Windows",
      "torch_version": "2.9.1+cu128",
      "model_parameters": 308676,
      "criterion": "CrossEntropyLoss",
      "class_weights": [
        0.4279378354549408,
        2.9077935218811035,
        0.8170527219772339,
        10.48245906829834
      ]
    },
    "train_loss": [
      1.3914618828742624,
      1.383690004726108,
      1.3784243608121391,
      1.3716620736413723,
      1.362362612708867,
      1.354119750021173,
      1.3354997163196263,
      1.30912309842144,
      1.289258355502602,
      1.2571279389395131,
      1.2220324553388486,
      1.3857605418712973,
      1.383433398154142,
      1.3806505304017513,
      1.3781873772470215,
      1.3723912054686238,
      1.3691060868956202,
      1.3619571263841588,
      1.3606769427549925,
      1.3576533702208842,
      1.3516956668534725,
      1.3456822749522093
    ],
    "train_acc": [
      0.2645085989903393,
      0.26376330628717676,
      0.23486563638153363,
      0.2252893282522183,
      0.22062070226259614,
      0.213913067934133,
      0.21152250643342285,
      0.22422060664013613,
      0.21641612644664127,
      0.22233628169251754,
      0.22595024819653228,
      0.2877111076737024,
      0.2588837484004331,
      0.2268361621644425,
      0.2585743816179883,
      0.23066106056557872,
      0.22364405945467072,
      0.2126052901719798,
      0.21541771546693292,
      0.21482710615499276,
      0.21091783499500794,
      0.21107251838623037
    ],
    "val_loss": [
      1.3745140045881272,
      1.3762760619322458,
      1.366732832789421,
      1.3560053964455923,
      1.3613993495702743,
      1.3446962823470434,
      1.3251916527748109,
      1.3206649512052535,
      1.274947714805603,
      1.234260090192159,
      1.2264316936333974,
      1.3795744995276134,
      1.3855413844188054,
      1.3724541972080866,
      1.3840766727924347,
      1.3816913415988286,
      1.3780475815137228,
      1.3804527471462886,
      1.3804138441880545,
      1.3804926921923955,
      1.3918536047140757,
      1.3843851139148076
    ],
    "val_acc": [
      0.3056611191193815,
      0.2291966976805137,
      0.21275062246101428,
      0.22841043113615517,
      0.19420783645655879,
      0.19637006945354477,
      0.21170226706853623,
      0.19656663608963437,
      0.21425763333770148,
      0.2103263006159088,
      0.20213602411217402,
      0.21969597693618137,
      0.14264185558904469,
      0.21314375573319355,
      0.1419866334687459,
      0.14788363255143494,
      0.15666360896343862,
      0.1552221202987813,
      0.15876031974839472,
      0.16026733062508192,
      0.14722841043113616,
      0.159153453020574
    ],
    "val_f1": [
      0.2971966807603377,
      0.23824828251186178,
      0.20559792309547456,
      0.22161348560138716,
      0.2057696689198247,
      0.21328764158878163,
      0.22497929891750962,
      0.22071774571486766,
      0.22053231815375934,
      0.20397880451220252,
      0.19864933412195118,
      0.2153108050937011,
      0.14865406234643283,
      0.15462903351964621,
      0.14479236709639245,
      0.15563286684683345,
      0.15486919752923867,
      0.1615859853432647,
      0.17395919286464126,
      0.18277560301738804,
      0.17547689951538215,
      0.18415736388108173
    ],
    "val_auroc": [
      0.5095820823995848,
      0.5081361773690275,
      0.5062466932733756,
      0.5100296662043197,
      0.5101135038813057,
      0.5117750226444343,
      0.5137965645143416,
      0.5132238081488433,
      0.5184963397957161,
      0.524439776109297,
      0.5257479859641497,
      0.5145449153069737,
      0.5042100731671344,
      0.50548167398864,
      0.5043974521162782,
      0.5046334021774269,
      0.5045843415098322,
      0.5054553755984745,
      0.5056383886309789,
      0.5056434492507329,
      0.5050689171621232,
      0.5051766217703073
    ],
    "val_sensitivity": [
      [
        0.17404562909419471,
        0.176602086438152,
        0.5951578947368421,
        0.189873417721519
      ],
      [
        0.11429862209170996,
        0.1825633383010432,
        0.4423157894736842,
        0.4430379746835443
      ],
      [
        0.07149311045854981,
        0.2548435171385991,
        0.44673684210526315,
        0.47468354430379744
      ],
      [
        0.08448159024169867,
        0.23323397913561847,
        0.47726315789473683,
        0.5
      ],
      [
        0.0815450643776824,
        0.23472429210134127,
        0.3646315789473684,
        0.6170886075949367
      ],
      [
        0.09769595662977186,
        0.3152011922503726,
        0.3162105263157895,
        0.6550632911392406
      ],
      [
        0.10232663203072058,
        0.27421758569299554,
        0.36378947368421055,
        0.7246835443037974
      ],
      [
        0.11271741585723967,
        0.3107302533532042,
        0.28210526315789475,
        0.7753164556962026
      ],
      [
        0.09735712672238536,
        0.37779433681073027,
        0.34926315789473683,
        0.7658227848101266
      ],
      [
        0.07781793539643099,
        0.47466467958271236,
        0.34,
        0.8512658227848101
      ],
      [
        0.07951208493336345,
        0.5178837555886736,
        0.29347368421052633,
        0.9240506329113924
      ],
      [
        0.08380393042692569,
        0.23174366616989567,
        0.456,
        0.4240506329113924
      ],
      [
        0.03727128981251412,
        0.19597615499254845,
        0.2922105263157895,
        0.620253164556962
      ],
      [
        0.010164897221594759,
        0.15201192250372578,
        0.5922105263157895,
        0.4620253164556962
      ],
      [
        0.03264061441156539,
        0.19225037257824143,
        0.2983157894736842,
        0.6424050632911392
      ],
      [
        0.0435961147503953,
        0.20715350223546944,
        0.29347368421052633,
        0.629746835443038
      ],
      [
        0.035238310368195164,
        0.20640834575260805,
        0.33789473684210525,
        0.6234177215189873
      ],
      [
        0.044725547775016944,
        0.1795827123695976,
        0.3214736842105263,
        0.6487341772151899
      ],
      [
        0.060424666817257736,
        0.16542473919523099,
        0.3061052631578947,
        0.6708860759493671
      ],
      [
        0.0730743166930201,
        0.15797317436661698,
        0.2886315789473684,
        0.6835443037974683
      ],
      [
        0.07442963632256608,
        0.12518628912071536,
        0.2503157894736842,
        0.7310126582278481
      ],
      [
        0.07680144567427151,
        0.13561847988077497,
        0.28210526315789475,
        0.7183544303797469
      ]
    ],
    "val_specificity": [
      [
        0.817103620474407,
        0.8670977011494253,
        0.4247526636225266,
        0.8977652883714706
      ],
      [
        0.8689138576779026,
        0.8636494252873563,
        0.570300608828006,
        0.6983139301485347
      ],
      [
        0.920099875156055,
        0.8255028735632184,
        0.5732496194824962,
        0.6930282349792587
      ],
      [
        0.9079275905118602,
        0.8455459770114943,
        0.5547945205479452,
        0.7085507828181453
      ],
      [
        0.9143258426966292,
        0.8331896551724138,
        0.6657153729071538,
        0.6043757527097551
      ],
      [
        0.9041822721598003,
        0.7658764367816092,
        0.7042427701674278,
        0.646527498996387
      ],
      [
        0.8951310861423221,
        0.798132183908046,
        0.670662100456621,
        0.6596413756188947
      ],
      [
        0.884207240948814,
        0.7717672413793103,
        0.7434360730593608,
        0.6222400642312325
      ],
      [
        0.9029338327091136,
        0.7233477011494253,
        0.6832191780821918,
        0.7197243409607922
      ],
      [
        0.9244694132334582,
        0.6767959770114943,
        0.6896879756468798,
        0.7452830188679245
      ],
      [
        0.927434456928839,
        0.65,
        0.732210806697108,
        0.7306971765020741
      ],
      [
        0.9038701622971286,
        0.8332614942528735,
        0.5528919330289194,
        0.7141710156563629
      ],
      [
        0.9588014981273408,
        0.8621408045977011,
        0.709855403348554,
        0.47464204469423255
      ],
      [
        0.9867353308364545,
        0.9043821839080459,
        0.4322678843226788,
        0.6905526562290913
      ],
      [
        0.9636392009987516,
        0.8698994252873563,
        0.7009132420091324,
        0.4709621303358758
      ],
      [
        0.9505305867665418,
        0.8584770114942529,
        0.7076674277016742,
        0.4884919041884116
      ],
      [
        0.95770911360799,
        0.858764367816092,
        0.6715182648401826,
        0.519536999866185
      ],
      [
        0.9530274656679151,
        0.8788074712643679,
        0.688165905631659,
        0.4896962397966011
      ],
      [
        0.9385143570536829,
        0.8834051724137931,
        0.704337899543379,
        0.4838752843570186
      ],
      [
        0.9222846441947565,
        0.8841954022988506,
        0.7264079147640792,
        0.4761140104375753
      ],
      [
        0.9210362047440699,
        0.9102729885057471,
        0.7596080669710806,
        0.41569650742673625
      ],
      [
        0.9197877652933832,
        0.9040229885057471,
        0.7294520547945206,
        0.4554395824969892
      ]
    ],
    "learning_rate": [
      6.35e-05,
      6.35e-05,
      6.35e-05,
      6.35e-05,
      3.175e-05,
      3.175e-05,
      3.175e-05,
      1.5875e-05,
      1.5875e-05,
      1.5875e-05,
      7.9375e-06,
      2.79e-05,
      2.79e-05,
      2.79e-05,
      2.79e-05,
      1.395e-05,
      1.395e-05,
      1.395e-05,
      6.975e-06,
      6.975e-06,
      6.975e-06,
      3.4875e-06
    ],
    "learning_rate_dict": [
      {
        "cnn": 6.35e-05,
        "lstm": 2.79e-05,
        "layer_norm": 6.35e-05,
        "fc": 6.35e-05
      },
      {
        "cnn": 6.35e-05,
        "lstm": 2.79e-05,
        "layer_norm": 6.35e-05,
        "fc": 6.35e-05
      },
      {
        "cnn": 6.35e-05,
        "lstm": 2.79e-05,
        "layer_norm": 6.35e-05,
        "fc": 6.35e-05
      },
      {
        "cnn": 6.35e-05,
        "lstm": 2.79e-05,
        "layer_norm": 6.35e-05,
        "fc": 6.35e-05
      },
      {
        "cnn": 3.175e-05,
        "lstm": 1.395e-05,
        "layer_norm": 3.175e-05,
        "fc": 3.175e-05
      },
      {
        "cnn": 3.175e-05,
        "lstm": 1.395e-05,
        "layer_norm": 3.175e-05,
        "fc": 3.175e-05
      },
      {
        "cnn": 3.175e-05,
        "lstm": 1.395e-05,
        "layer_norm": 3.175e-05,
        "fc": 3.175e-05
      },
      {
        "cnn": 1.5875e-05,
        "lstm": 6.975e-06,
        "layer_norm": 1.5875e-05,
        "fc": 1.5875e-05
      },
      {
        "cnn": 1.5875e-05,
        "lstm": 6.975e-06,
        "layer_norm": 1.5875e-05,
        "fc": 1.5875e-05
      },
      {
        "cnn": 1.5875e-05,
        "lstm": 6.975e-06,
        "layer_norm": 1.5875e-05,
        "fc": 1.5875e-05
      },
      {
        "cnn": 7.9375e-06,
        "lstm": 3.4875e-06,
        "layer_norm": 7.9375e-06,
        "fc": 7.9375e-06
      },
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null
    ],
    "epochs_completed": 22,
    "best_epoch": 1,
    "best_val_f1": 0.2971966807603377,
    "stopped_early": true,
    "start_time": "2025-12-10T22:31:03.358447",
    "end_time": "2025-12-10T22:43:41.229803"
  },
  "test": {
    "loss": 1.3772575444534045,
    "accuracy": 0.20704029643353405,
    "f1": 0.20157308846475028,
    "auroc": 0.5051540584035245,
    "sensitivity": [
      0.08077744073699585,
      0.19638455217748563,
      0.4321041214750542,
      0.4649350649350649
    ],
    "specificity": [
      0.9069542820347715,
      0.83664363845711,
      0.540321812815386,
      0.7074959261271049
    ]
  }
}