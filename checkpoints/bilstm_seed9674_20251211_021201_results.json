{
  "config": {
    "run_id": "bilstm_seed9674_20251211_021201",
    "timestamp": "20251211_021201",
    "datetime": "2025-12-11T02:12:01.982115",
    "model_name": "bilstm",
    "model_file": "model_bilstm.py",
    "model_class": "CNNBiLSTM",
    "split_dir": "data/splits",
    "batch_size": 64,
    "num_epochs": 100,
    "patience": 10,
    "seed": 9674,
    "optimizer": "Adam",
    "learning_rate": 0.000812,
    "rnn_learning_rate": 2.47e-05,
    "differential_lr": true,
    "weight_decay": 8.25e-06,
    "freeze_cnn": false,
    "scheduler": "ReduceLROnPlateau",
    "scheduler_mode": "max",
    "scheduler_factor": 0.5,
    "scheduler_patience": 5,
    "gradient_clip_norm": 1.0,
    "save_dir": "checkpoints",
    "model_path": "checkpoints\\bilstm_seed9674_20251211_021201.pt",
    "log_path": "checkpoints\\bilstm_seed9674_20251211_021201_history.json",
    "results_path": "checkpoints\\bilstm_seed9674_20251211_021201_results.json",
    "device": "cuda",
    "user": "tomra",
    "platform": "Windows",
    "torch_version": "2.9.1+cu128",
    "model_parameters": 316612,
    "criterion": "CrossEntropyLoss",
    "class_weights": [
      0.4279378354549408,
      2.9077935218811035,
      0.8170527219772339,
      10.48245906829834
    ]
  },
  "history": {
    "config": {
      "run_id": "bilstm_seed9674_20251211_021201",
      "timestamp": "20251211_021201",
      "datetime": "2025-12-11T02:12:01.982115",
      "model_name": "bilstm",
      "model_file": "model_bilstm.py",
      "model_class": "CNNBiLSTM",
      "split_dir": "data/splits",
      "batch_size": 64,
      "num_epochs": 100,
      "patience": 10,
      "seed": 9674,
      "optimizer": "Adam",
      "learning_rate": 0.000812,
      "rnn_learning_rate": 2.47e-05,
      "differential_lr": true,
      "weight_decay": 8.25e-06,
      "freeze_cnn": false,
      "scheduler": "ReduceLROnPlateau",
      "scheduler_mode": "max",
      "scheduler_factor": 0.5,
      "scheduler_patience": 5,
      "gradient_clip_norm": 1.0,
      "save_dir": "checkpoints",
      "model_path": "checkpoints\\bilstm_seed9674_20251211_021201.pt",
      "log_path": "checkpoints\\bilstm_seed9674_20251211_021201_history.json",
      "results_path": "checkpoints\\bilstm_seed9674_20251211_021201_results.json",
      "device": "cuda",
      "user": "tomra",
      "platform": "Windows",
      "torch_version": "2.9.1+cu128",
      "model_parameters": 316612,
      "criterion": "CrossEntropyLoss",
      "class_weights": [
        0.4279378354549408,
        2.9077935218811035,
        0.8170527219772339,
        10.48245906829834
      ]
    },
    "train_loss": [
      1.2214766517817546,
      1.113145665191918,
      1.076653424998839,
      1.041339437416989,
      1.0185903743338243,
      0.9962312921131258,
      0.9798248198499783,
      0.962439963178669,
      0.942610941157281,
      0.9330438911218009,
      0.9234008606014062,
      0.910699196669052,
      0.904995928886983,
      0.8932820965917848,
      0.8829052215643066,
      0.8776744968331546,
      0.8716541960728255,
      0.8593143070880458,
      0.8327592023842626,
      0.8201370109810675,
      0.8184122129095545,
      0.8137318148083396,
      0.8099900662845416,
      0.8025261262873952,
      0.7860299561092322,
      0.7796071740202337,
      0.7792195080102776,
      0.771338468859736,
      0.7710843615019493,
      0.7650838973228451,
      0.7611050558604783
    ],
    "train_acc": [
      0.349204786747852,
      0.4041877012641852,
      0.4327056937550096,
      0.4540238774907541,
      0.47012501230436066,
      0.4849605557352383,
      0.5016101134813606,
      0.5113832913813227,
      0.5189909018041708,
      0.5259235301562303,
      0.5313093245960654,
      0.5408293842194817,
      0.540449706804663,
      0.5468901607301057,
      0.5485354295276532,
      0.556578965871219,
      0.5606851068018506,
      0.5632022274408336,
      0.5757315821298497,
      0.5787830635748737,
      0.5784596346659542,
      0.5811876872020587,
      0.5848157158325482,
      0.5836063729557184,
      0.5950388817797028,
      0.5982872329953736,
      0.5985122270189698,
      0.6023230632936313,
      0.6003684277136389,
      0.6039261457117545,
      0.6022105662818331
    ],
    "val_loss": [
      1.1659727373382536,
      1.1578630858634804,
      1.1466747574726408,
      1.110537337583478,
      1.0964116004595696,
      1.0710377427573983,
      1.0373558867800685,
      1.0289668323604633,
      1.0279659145671454,
      1.0150946672990233,
      1.009386959435052,
      1.0541120113563338,
      1.0123689225777424,
      1.003381659420963,
      0.9915765326267506,
      1.004721344140783,
      0.9859089354466195,
      0.9818552301019804,
      0.9894627777228295,
      0.9741856836125442,
      0.9760231330803747,
      0.9905224192466696,
      0.9783054261651498,
      0.9881702214479446,
      0.9892481245006977,
      0.9788626178662647,
      0.9889142814415768,
      0.9854629383925114,
      0.9850287674984672,
      0.9757114794713184,
      0.989232242730871
    ],
    "val_acc": [
      0.39287118333114923,
      0.42641855589044686,
      0.4109553138513956,
      0.4590486174813262,
      0.4783776700301402,
      0.5186738304285152,
      0.5022932774210457,
      0.5298781286856244,
      0.5205739745773817,
      0.5323024505307299,
      0.5600838684313982,
      0.5146114532826628,
      0.5304678285938933,
      0.5723365220809854,
      0.5744987550779714,
      0.5693225003276111,
      0.5687983226313721,
      0.5574629799502031,
      0.5705674223561787,
      0.5885860306643952,
      0.6018870397064605,
      0.5686017559952824,
      0.5821648538854671,
      0.587079019787708,
      0.5879963307561263,
      0.6009697287380422,
      0.6012318175861617,
      0.5950072074433232,
      0.594614074171144,
      0.5954003407155025,
      0.605359716944044
    ],
    "val_f1": [
      0.4203822851898295,
      0.42354522624600144,
      0.4426818194462967,
      0.4756653842118963,
      0.48313337747751633,
      0.5172044995705745,
      0.5298105804218313,
      0.5420290078817729,
      0.5460678228968002,
      0.5494941965854704,
      0.557760352571949,
      0.5292410449357232,
      0.5430029799501385,
      0.5602024706742906,
      0.5813332431512288,
      0.5724209822324159,
      0.5773350043005103,
      0.5754081950134847,
      0.5778987210557314,
      0.5951503273253983,
      0.6093696860424155,
      0.5871454370738366,
      0.5933541197260412,
      0.5954523769504764,
      0.5953748694531394,
      0.6087054953333952,
      0.6093548832521515,
      0.6029420689342361,
      0.6041705653730517,
      0.6079675910458134,
      0.6079044865871837
    ],
    "val_auroc": [
      0.5776779904588701,
      0.594617298699688,
      0.6193291610496776,
      0.6336159578001499,
      0.6570880939222118,
      0.6572830094173326,
      0.6842572841076492,
      0.6902662231096108,
      0.6901547987641747,
      0.7021454307882149,
      0.7083153022798216,
      0.6990238044316962,
      0.7082254951967322,
      0.7112227460799263,
      0.7185252123263902,
      0.7161621767105661,
      0.7208009421494944,
      0.7206662198825883,
      0.7235832689486851,
      0.7319906688691077,
      0.7318498282090833,
      0.7292133450561565,
      0.7332054547312815,
      0.7331614770233043,
      0.7346181252469246,
      0.737942899833994,
      0.7384829382653098,
      0.7364611683365515,
      0.73827638118214,
      0.7400907521050146,
      0.739071457446929
    ],
    "val_sensitivity": [
      [
        0.37655297040885477,
        0.30923994038748137,
        0.42147368421052633,
        0.7753164556962026
      ],
      [
        0.5908064151795799,
        0.4731743666169896,
        0.08273684210526316,
        0.7879746835443038
      ],
      [
        0.4798960921617348,
        0.5737704918032787,
        0.21073684210526317,
        0.7974683544303798
      ],
      [
        0.5781567653038174,
        0.4970193740685544,
        0.20273684210526316,
        0.8132911392405063
      ],
      [
        0.6306754009487238,
        0.5715350223546944,
        0.14757894736842106,
        0.7879746835443038
      ],
      [
        0.6967472328890897,
        0.4247391952309985,
        0.19136842105263158,
        0.8481012658227848
      ],
      [
        0.559182290490174,
        0.5879284649776453,
        0.35136842105263155,
        0.8132911392405063
      ],
      [
        0.6587982832618026,
        0.5849478390461997,
        0.2543157894736842,
        0.8259493670886076
      ],
      [
        0.5956629771854529,
        0.5745156482861401,
        0.34589473684210525,
        0.8132911392405063
      ],
      [
        0.6451321436638807,
        0.6289120715350224,
        0.276,
        0.8132911392405063
      ],
      [
        0.731420826744974,
        0.5842026825633383,
        0.21747368421052632,
        0.8069620253164557
      ],
      [
        0.6450192003614186,
        0.6616989567809239,
        0.2065263157894737,
        0.8670886075949367
      ],
      [
        0.6589112265642647,
        0.6788375558867362,
        0.23221052631578948,
        0.7848101265822784
      ],
      [
        0.7606731420826744,
        0.5916542473919523,
        0.1985263157894737,
        0.8322784810126582
      ],
      [
        0.709396882764852,
        0.6020864381520119,
        0.30294736842105263,
        0.759493670886076
      ],
      [
        0.7211429862209171,
        0.6281669150521609,
        0.25284210526315787,
        0.8227848101265823
      ],
      [
        0.7082674497402304,
        0.639344262295082,
        0.27221052631578946,
        0.819620253164557
      ],
      [
        0.655635870792862,
        0.6706408345752608,
        0.3263157894736842,
        0.8006329113924051
      ],
      [
        0.708719222950079,
        0.6751117734724292,
        0.2694736842105263,
        0.7816455696202531
      ],
      [
        0.7151569911904224,
        0.6639344262295082,
        0.32042105263157894,
        0.7531645569620253
      ],
      [
        0.7266772080415631,
        0.589418777943368,
        0.36105263157894735,
        0.7784810126582279
      ],
      [
        0.6452450869663429,
        0.6572280178837556,
        0.38905263157894737,
        0.7436708860759493
      ],
      [
        0.6965213462841654,
        0.665424739195231,
        0.33431578947368423,
        0.75
      ],
      [
        0.710752202394398,
        0.6616989567809239,
        0.32442105263157894,
        0.7531645569620253
      ],
      [
        0.7156087644002711,
        0.6982116244411326,
        0.3077894736842105,
        0.7563291139240507
      ],
      [
        0.7223853625480009,
        0.6445603576751118,
        0.35389473684210526,
        0.7278481012658228
      ],
      [
        0.7194488366839846,
        0.6371087928464978,
        0.36336842105263156,
        0.7120253164556962
      ],
      [
        0.7193358933815225,
        0.6758569299552906,
        0.33157894736842103,
        0.7278481012658228
      ],
      [
        0.7104133724870115,
        0.6713859910581222,
        0.3471578947368421,
        0.7436708860759493
      ],
      [
        0.6882764852044274,
        0.6520119225037257,
        0.39621052631578946,
        0.7468354430379747
      ],
      [
        0.7441834199231986,
        0.6609538002980626,
        0.32442105263157894,
        0.7025316455696202
      ]
    ],
    "val_specificity": [
      [
        0.7308052434456929,
        0.8667385057471264,
        0.6374619482496194,
        0.874548374146929
      ],
      [
        0.5337078651685393,
        0.7640086206896551,
        0.9432077625570776,
        0.8739462063428342
      ],
      [
        0.6992821473158551,
        0.7236350574712643,
        0.870814307458143,
        0.8756858022213301
      ],
      [
        0.6039325842696629,
        0.8094827586206896,
        0.8831811263318112,
        0.8770239528970962
      ],
      [
        0.5948813982521848,
        0.7831896551724138,
        0.9419710806697108,
        0.883781613809715
      ],
      [
        0.517478152309613,
        0.8976293103448276,
        0.9254185692541856,
        0.8631740934029172
      ],
      [
        0.7192571785268415,
        0.8355603448275862,
        0.8230593607305936,
        0.8897363843168741
      ],
      [
        0.6349875156054932,
        0.8495689655172414,
        0.8984018264840182,
        0.8879967884383781
      ],
      [
        0.7052122347066168,
        0.8452586206896552,
        0.8447488584474886,
        0.890137829519604
      ],
      [
        0.6730649188514357,
        0.8169540229885057,
        0.9023972602739726,
        0.9017128328649806
      ],
      [
        0.5959737827715356,
        0.8535201149425288,
        0.9390220700152208,
        0.9033186136758999
      ],
      [
        0.6690074906367042,
        0.8145833333333333,
        0.935882800608828,
        0.8640438913421651
      ],
      [
        0.6771223470661673,
        0.7844827586206896,
        0.9226598173515982,
        0.9140907266158169
      ],
      [
        0.5535268414481898,
        0.8809626436781609,
        0.9512937595129376,
        0.8998394219189081
      ],
      [
        0.6423220973782772,
        0.8597701149425288,
        0.8939307458143074,
        0.9240599491502743
      ],
      [
        0.6257802746566792,
        0.8561063218390804,
        0.9288432267884322,
        0.9047236718854543
      ],
      [
        0.6512172284644194,
        0.8510775862068966,
        0.9241818873668188,
        0.9012444801284625
      ],
      [
        0.7044319600499376,
        0.8344109195402298,
        0.8832762557077626,
        0.9111467951291315
      ],
      [
        0.66354556803995,
        0.8341954022988506,
        0.9207572298325722,
        0.9158972300281012
      ],
      [
        0.6568352059925093,
        0.8584770114942529,
        0.8985920852359208,
        0.93014853472501
      ],
      [
        0.6502808988764045,
        0.898419540229885,
        0.8812785388127854,
        0.9215174628663187
      ],
      [
        0.7197253433208489,
        0.8504310344827586,
        0.8466514459665144,
        0.9268031580355948
      ],
      [
        0.6839887640449438,
        0.8540948275862069,
        0.8843226788432268,
        0.9260671751639235
      ],
      [
        0.66729088639201,
        0.8589080459770115,
        0.8948820395738204,
        0.9263348052990766
      ],
      [
        0.6744694132334582,
        0.8390804597701149,
        0.909627092846271,
        0.9322895758062358
      ],
      [
        0.6683832709113608,
        0.8776580459770115,
        0.8834665144596652,
        0.9306168874615282
      ],
      [
        0.6705680399500624,
        0.8801005747126437,
        0.8757610350076104,
        0.9330924662116954
      ],
      [
        0.6768102372034956,
        0.8558908045977012,
        0.8951674277016742,
        0.9329586511441188
      ],
      [
        0.6839887640449438,
        0.8602011494252874,
        0.8857496194824962,
        0.9320888532048709
      ],
      [
        0.7019350811485643,
        0.8751436781609195,
        0.8530251141552512,
        0.934296801819885
      ],
      [
        0.651685393258427,
        0.8655890804597701,
        0.9010654490106544,
        0.941121370266292
      ]
    ],
    "learning_rate": [
      0.000812,
      0.000812,
      0.000812,
      0.000812,
      0.000812,
      0.000812,
      0.000812,
      0.000812,
      0.000812,
      0.000812,
      0.000812,
      0.000812,
      0.000812,
      0.000812,
      0.000812,
      0.000812,
      0.000812,
      0.000812,
      0.000406,
      0.000406,
      0.000406,
      0.000406,
      0.000406,
      0.000406,
      0.000203,
      0.000203,
      0.000203,
      0.0001015,
      0.0001015,
      0.0001015,
      5.075e-05
    ],
    "learning_rate_dict": [
      {
        "cnn": 0.000812,
        "lstm": 2.47e-05,
        "fc": 0.000812
      },
      {
        "cnn": 0.000812,
        "lstm": 2.47e-05,
        "fc": 0.000812
      },
      {
        "cnn": 0.000812,
        "lstm": 2.47e-05,
        "fc": 0.000812
      },
      {
        "cnn": 0.000812,
        "lstm": 2.47e-05,
        "fc": 0.000812
      },
      {
        "cnn": 0.000812,
        "lstm": 2.47e-05,
        "fc": 0.000812
      },
      {
        "cnn": 0.000812,
        "lstm": 2.47e-05,
        "fc": 0.000812
      },
      {
        "cnn": 0.000812,
        "lstm": 2.47e-05,
        "fc": 0.000812
      },
      {
        "cnn": 0.000812,
        "lstm": 2.47e-05,
        "fc": 0.000812
      },
      {
        "cnn": 0.000812,
        "lstm": 2.47e-05,
        "fc": 0.000812
      },
      {
        "cnn": 0.000812,
        "lstm": 2.47e-05,
        "fc": 0.000812
      },
      {
        "cnn": 0.000812,
        "lstm": 2.47e-05,
        "fc": 0.000812
      },
      {
        "cnn": 0.000812,
        "lstm": 2.47e-05,
        "fc": 0.000812
      },
      {
        "cnn": 0.000812,
        "lstm": 2.47e-05,
        "fc": 0.000812
      },
      {
        "cnn": 0.000812,
        "lstm": 2.47e-05,
        "fc": 0.000812
      },
      {
        "cnn": 0.000812,
        "lstm": 2.47e-05,
        "fc": 0.000812
      },
      {
        "cnn": 0.000812,
        "lstm": 2.47e-05,
        "fc": 0.000812
      },
      {
        "cnn": 0.000812,
        "lstm": 2.47e-05,
        "fc": 0.000812
      },
      {
        "cnn": 0.000812,
        "lstm": 2.47e-05,
        "fc": 0.000812
      },
      {
        "cnn": 0.000406,
        "lstm": 1.235e-05,
        "fc": 0.000406
      },
      {
        "cnn": 0.000406,
        "lstm": 1.235e-05,
        "fc": 0.000406
      },
      {
        "cnn": 0.000406,
        "lstm": 1.235e-05,
        "fc": 0.000406
      },
      {
        "cnn": 0.000406,
        "lstm": 1.235e-05,
        "fc": 0.000406
      },
      {
        "cnn": 0.000406,
        "lstm": 1.235e-05,
        "fc": 0.000406
      },
      {
        "cnn": 0.000406,
        "lstm": 1.235e-05,
        "fc": 0.000406
      },
      {
        "cnn": 0.000203,
        "lstm": 6.175e-06,
        "fc": 0.000203
      },
      {
        "cnn": 0.000203,
        "lstm": 6.175e-06,
        "fc": 0.000203
      },
      {
        "cnn": 0.000203,
        "lstm": 6.175e-06,
        "fc": 0.000203
      },
      {
        "cnn": 0.0001015,
        "lstm": 3.0875e-06,
        "fc": 0.0001015
      },
      {
        "cnn": 0.0001015,
        "lstm": 3.0875e-06,
        "fc": 0.0001015
      },
      {
        "cnn": 0.0001015,
        "lstm": 3.0875e-06,
        "fc": 0.0001015
      },
      {
        "cnn": 5.075e-05,
        "lstm": 1.54375e-06,
        "fc": 5.075e-05
      }
    ],
    "epochs_completed": 31,
    "best_epoch": 21,
    "best_val_f1": 0.6093696860424155,
    "stopped_early": true,
    "start_time": "2025-12-11T02:12:03.900815",
    "end_time": "2025-12-11T02:43:56.253436"
  },
  "test": {
    "loss": 0.9625936403304716,
    "accuracy": 0.6042479984119632,
    "f1": 0.6116686893347444,
    "auroc": 0.7377616151617888,
    "sensitivity": [
      0.7307044152342433,
      0.561216105176664,
      0.3577006507592191,
      0.7688311688311689
    ],
    "specificity": [
      0.662105602060528,
      0.8979562464018422,
      0.8730838807959631,
      0.923207495926127
    ]
  }
}